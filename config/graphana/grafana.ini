[server]
domain = ${GRAPHANA_DOMAIN}
protocol = https
enforce_domain = true
root_url = ${GRAPHANA_URL}
enable_gzip = true
cert_file = /ssl/fullchain.pem
cert_key = /ssl/privkey.pem

[session]
cookie_secure = true

[auth]
disable_login_form = true
signout_redirect_url = 

[auth.basic]
enabled = false

[auth.generic_oauth]
name = Authentik
icon = signin
enabled = true
client_id = ${GRAPHANA_OAUTH_CLIENT_ID}
client_secret = ${GRAPHANA_OAUTH_CLIENT_SECRET}
scopes = openid profile email
auth_url = ${GRAPHANA_AUTH_URL}
token_url = ${GRAPHANA_TOKEN_URL}
api_url = ${GRAPHANA_USERINFO_URL}
allow_sign_up = true
use_pkce = true
role_attribute_path = contains(groups[*], 'management') && 'Admin' || contains(groups[*], 'Grafana Editors') && 'Editor' || 'Viewer'

[database]

type = postgres
host = database
name = ${GRAPHANA_POSTGRESQL__DB}
user = ${GRAPHANA_POSTGRESQL__USER}
password = ${GRAPHANA_POSTGRESQL__PASSWORD}
log_queries = false